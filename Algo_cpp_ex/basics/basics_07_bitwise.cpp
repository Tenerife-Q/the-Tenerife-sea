#include <iostream>
#include <bitset> // 用于输出二进制格式

using namespace std;

/**
 * ============================================================
 * 基础语法 - 位运算 (Bitwise Operations)
 * ============================================================
 * 
 * 位运算是直接对整数在内存中的二进制位进行操作，通常比普通算术运算更快。
 * 
 * 常见运算符：
 * 1. & (按位与): 两个位都为 1 时，结果才为 1
 * 2. | (按位或): 只要有一个位为 1，结果就为 1
 * 3. ^ (按位异或): 两个位不同则为 1，相同则为 0 (不进位加法)
 * 4. ~ (按位取反): 0 变 1，1 变 0
 * 5. << (左移): 各二进位全部左移若干位，高位丢弃，低位补0 (相当于乘以 2)
 * 6. >> (右移): 各二进位全部右移若干位，对无符号数，高位补0 (相当于除以 2)
 * 
 * 优先级注意：
 * 算术运算符 (+, -) 优先级高于 位移运算符 (<<, >>)
 * 所以 l + r >> 1 等价于 (l + r) >> 1
 */

int main() {
    int a = 5;  // 二进制: 0000 0101
    int b = 3;  // 二进制: 0000 0011

    cout << "a = " << a << ", b = " << b << endl;

    // 1. 按位与 (&) - 这里的 mask 掩码操作很常见
    // 0101
    // 0011
    // ----
    // 0001 -> 1
    cout << "a & b = " << (a & b) << endl; 

    // 2. 按位或 (|)
    // 0101
    // 0011
    // ----
    // 0111 -> 7
    cout << "a | b = " << (a | b) << endl;

    // 3. 按位异或 (^) - 相同为0，不同为1
    // 0101
    // 0011
    // ----
    // 0110 -> 6
    cout << "a ^ b = " << (a ^ b) << endl;

    // 4. 按位取反 (~)
    // 注意：int 通常是 32 位，~5 会变成非常大的负数（补码表示）
    cout << "~a = " << (~a) << endl; 

    // 5. 左移 (<<) - 乘以 2 的幂
    // 5 (0101) << 1 -> 1010 (10)
    cout << "a << 1 = " << (a << 1) << " (5 * 2)" << endl;

    // 6. 右移 (>>) - 除以 2 的幂
    // 5 (0101) >> 1 -> 0010 (2)
    cout << "a >> 1 = " << (a >> 1) << " (5 / 2)" << endl;

    // ==========================================
    // 关于 Quick Sort 中的 l + r >> 1
    // ==========================================
    int l = 0;
    int r = 10;
    
    // 优先级演示
    // C++ 中 '+' 的优先级 (Level 6) 高于 '>>' (Level 11) *注意：数值越小优先级越高，这里通常指 + 优于 >>
    // 准确说是：算术运算(+,-) 优先于 位移运算(<<, >>)
    
    int result1 = l + r >> 1;   // 先算 l+r=10，再 10>>1=5
    int result2 = (l + r) / 2;  // 10 / 2 = 5
    int result3 = l + (r >> 1); // 0 + (10>>1) = 5 (在这个例子碰巧一样，换个例子就不一定了)

    cout << "\n=== 优先级测试 l=0, r=10 ===" << endl;
    cout << "l + r >> 1  = " << result1 << endl;
    cout << "(l + r) / 2 = " << result2 << endl;

    // 特例测试
    l = 2; r = 6;
    // l+r = 8, 8>>1 = 4
    // r>>1 = 3, l+3 = 5
    cout << "\n=== 优先级测试 l=2, r=6 ===" << endl;
    cout << "l + r >> 1     = " << (l + r >> 1) << " (Correct: (2+6)>>1 = 4)" << endl;
    cout << "l + (r >> 1)   = " << (l + (r >> 1)) << " (Wrong logic: 2+(6>>1) = 5)" << endl;

    return 0;
}
