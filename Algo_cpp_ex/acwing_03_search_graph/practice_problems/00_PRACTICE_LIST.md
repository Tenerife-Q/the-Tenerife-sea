# 第三章 搜索与图论 - 综合练习题

这里精选了几道经典的算法竞赛风格题目，涵盖了本章学习的核心算法。
这些题目往往不是直接让你套板子，而是需要你分析题目性质，选择合适的图论模型。

## 题目 1: 迷宫救援 (BFS + 最短路变形)
**标签**: `BFS` `状态压缩`
**难度**: ⭐⭐⭐

### 题目描述
你被困在一个 $N \times M$ 的迷宫中，终点是 $(N, M)$。迷宫中有一些门是锁着的，必须拿到对应的钥匙才能打开。
钥匙和门只有几类（比如 'A' 锁需要 'a' 钥匙）。
求从起点 $(1, 1)$ 到终点的最短步数。如果不通，输出 -1。

### 考察点
普通的 BFS 只能记录坐标 $(x, y)$。但这里有钥匙的状态。
你需要把状态定义为 $(x, y, state)$，其中 $state$ 是一个二进制数，表示你捡到了哪些钥匙。
比如 `101` 表示捡到了第1把和第3把钥匙。
这其实是把图“分层”了。

---

## 题目 2: 城市贸易 (SPFA/Dijkstra + 动态规划思想)
**标签**: `最短路` `分层图`
**难度**: ⭐⭐⭐

### 题目描述
C 国有 $N$ 个城市，城市间有单向道路。
每个城市都有一个商品价格 $P_i$。
你是一个商人，你想从城市 1 出发，走到城市 $N$。
你在路途中，可以在**某个**城市买入一次商品，然后在之后的**某个**城市卖出一次商品（只能买卖各一次）。
求最大利润。

### 考察点
如果只是求最短路，用 Dijkstra 就行。
但这里要求利润 $max(P_{sell} - P_{buy})$。
这道题可以用 **分层图最短路** 或者 **正反两次 SPFA** 来做。
1. `dmin[i]`: 从起点走到 i 的过程中，经过的最小价格。
2. `dmax[i]`: 从 i 走到终点的过程中，经过的最大价格（这需要建反图从 N 跑 SPFA）。
3. 答案就是枚举每个中间点 $i$，计算 `dmax[i] - dmin[i]` 的最大值。

---

## 题目 3: 繁忙的物流 (Kruskal / Prim 变种)
**标签**: `最小生成树` `二分答案`
**难度**: ⭐⭐⭐⭐

### 题目描述
你要在 $N$ 个物流中心之间建立连接网络。
每条连接线都有两个属性：建设成本 $C$ 和 维护成本 $V$。
现在要求选出 $N-1$ 条边让图连通，使得 $\frac{\sum C}{\sum V}$ （总建设成本除以总维护成本）的值最小。

### 考察点
这道题不是简单的 MST。因为目标函数是分数。
这是典型的 **0/1 分数规划** 问题，通常结合二分法。
假设答案是 $x$，我们需要判断是否存在一种方案使得 $\frac{\sum C}{\sum V} \le x$。
变形得 $\sum C \le x \cdot \sum V \Rightarrow \sum (C - x \cdot V) \le 0$。
把每条边的权重重新定义为 $W_i = C_i - x \cdot V_i$。
然后跑一遍 Kruskal 看看最小生成树的权值是否 $\le 0$。

---

## 题目 4: 战略会议 (树的重心 / 树型DP)
**标签**: `DFS` `树的重心`
**难度**: ⭐⭐

### 题目描述
某公司组织架构是一棵树。现在要召开会议，所有员工都要去同一个节点开会。
每条边代表路程。请问会议地点选在哪里，所有员工走的总路程之和最小？

### 考察点
这其实就是求 **树的重心** 的变种（带权重心）。
1. 可以暴力换根 DP：先假设根是 1，算出总距离。然后试着把根移到 1 的子节点，看看总距离怎么变（利用子树大小快速计算）。
2. 或者直接找树的重心性质。

---

## 题目 5: 犯罪团伙 (并查集 / 二分图)
**标签**: `并查集` `二分图`
**难度**: ⭐⭐⭐

### 题目描述
警察局发现有 $N$ 个罪犯。现有 $M$ 条线索，每条线索指出两个罪犯 $a$ 和 $b$ 是同伙（必须在同一个监狱）或者 是死敌（必须在不同监狱）。
现在只有两个监狱 A 和 B。
问：给出的线索是否存在矛盾？如果存在，最早在哪一条线索出现矛盾？

### 考察点
这可以用 **带权并查集** 或者 **扩展域并查集**。
或者直接看作二分图判定。
"死敌"就是二分图的边（必须分两边）。
"同伙"就是缩点（合并成一个点）。

---

## 练习指南
建议先尝试 **题目 2 (城市贸易)** 和 **题目 5 (犯罪团伙)**。
这两道题分别考察了最短路的灵活应用（正反建图）和二分图/并查集的性质，是面试和比赛的高频题型。
